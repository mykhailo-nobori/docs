{"version":3,"file":"prepare.js","sourceRoot":"","sources":["../../src/lib/prepare.ts"],"names":[],"mappings":"AAAA;;;GAGG;AAEH,OAAO,EAAmB,KAAK,EAAE,MAAM,OAAO,CAAC;AAC/C,OAAO,EAAE,MAAM,EAAE,MAAM,cAAc,CAAC;AAItC;;;;;;GAMG;AACH,MAAM,UAAU,OAAO,CACrB,MAAkB,EAClB,gBAA0B;IAE1B,MAAM,KAAK,GAAG,eAAe,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,IAAI,KAAK,CAAC,MAAM,CAAC,CAAC;IAEnE,oDAAoD;IACpD,IAAI,gBAAgB;QAAE,MAAM,CAAC,KAAK,EAAE,EAAE,KAAK,EAAE,IAAI,EAAE,CAAC,CAAC;IAErD,MAAM,WAAW,GAAG,CAAC,KAAK,CAAC,IAAI,CAAC,MAAM,IAAI,EAAE,CAAiB,CAAC;IAE9D,OAAO;QACL,KAAK;QACL,WAAW;KACZ,CAAC;AACJ,CAAC;AAED;;GAEG;AACH,SAAS,eAAe,CAAC,KAAkB;IACzC,OAAO,OAAO,CACZ,KAAK,IAAI,OAAO,KAAK,KAAK,QAAQ,IAAI,SAAS,IAAI,KAAK,IAAI,UAAU,IAAI,KAAK,CAChF,CAAC;AACJ,CAAC","sourcesContent":["/**\n * Copyright (c) @talatkuyuk AKA @ipikuka\n * SPDX-License-Identifier: MPL-2.0\n */\n\nimport { type Compatible, VFile } from \"vfile\";\nimport { matter } from \"vfile-matter\";\n\nimport type { PrepareResult } from \"./types.js\";\n\n/**\n * turns the source into vfile, gets the fronmatter, strips it out from the vfile\n *\n * @param source markdown or MDX source\n * @param parseFrontmatter indicates whether or not the frontmatter should be parsed out of the source\n * @returns the frontmatter and stripped vfile\n */\nexport function prepare<TFrontmatter extends Record<string, unknown> = Record<string, unknown>>(\n  source: Compatible,\n  parseFrontmatter?: boolean,\n): PrepareResult<TFrontmatter> {\n  const vfile = looksLikeAVFile(source) ? source : new VFile(source);\n\n  // makes frontmatter available via vfile.data.matter\n  if (parseFrontmatter) matter(vfile, { strip: true });\n\n  const frontmatter = (vfile.data.matter ?? {}) as TFrontmatter;\n\n  return {\n    vfile,\n    frontmatter,\n  };\n}\n\n/**\n * taken from @mdx-js/mdx/lib/util/resolve-file-and-options.js\n */\nfunction looksLikeAVFile(value?: Compatible): value is VFile {\n  return Boolean(\n    value && typeof value === \"object\" && \"message\" in value && \"messages\" in value,\n  );\n}\n"]}